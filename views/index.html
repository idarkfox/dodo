<!--
 * @Descripttion: 
 * @version: 
 * @Author: idarkfox
 * @Date: 2022-06-16 19:35:42
 * @LastEditors: Please set LastEditors
 * @LastEditTime: 2022-07-06 16:23:48
-->
<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no, minimal-ui">
    <title>dodo test</title>
    <link rel='stylesheet' href='/stylesheets/style.css' />
    <script defer type="module" src="javascripts/dodo.js"></script>
    <script defer type="module" src="javascripts/traditional-import.js"></script>
    <!-- <do-do use="./bean.js" hold="true" init="true"></do-do> -->

    <!-- <do-do use="./template/template-dodo.js" hold="true" init="true"></do-do> -->
    <!-- <do-do use="./template/template-extends-tags.js" hold="true" ></do-do> -->

    <!-- <do-do use="./template/template-tags.js" hold="true" init="true"></do-do> -->
    <!-- <do-do use="./component-edit.js" init="true"></do-do> -->

    <script type="module" defer>
        import TemplateDodo from "/javascripts/template/template-dodo.js";
        customElements.whenDefined("dodo-tpl").then(()=>{
            window.dispatchEvent(new CustomEvent("templatedodo-complete",{
                bubbles:false,cancelable:false
            }));
        });
    </script>

    <script>
        var list1 = [{ a: 1, b: 2 }, { a: 3, b: 4 }, { a: 4, b: 6 }, { a: 7, b: 8 }, { a: 9, b: 10 }, { a: 11, b: 12 }, { a: 13, b: 14 }, { a: 15, b: 16 }];
        var list2 = [{ a: [{ c: 'c1' }, { c: 'c2' }, { c: 'c3' }], b: 2 }, { a: [{ c: 'c4' }, { c: 'c5' }, { c: 'c6' }], b: 4 }, { a: [{ c: 'c7' }, { c: 'c8' }, { c: 'c9' }], b: 6 }, { a: [{ c: 'c10' }, { c: 'c11' }, { c: 'c12' }], b: 8 }];
        var list3 = [{ a: 1, b: 2 }, { a: 3, b: 4 }, { a: 4, b: 6 }];

        var list4 = [{ a: [{ c: 'c1' }, { c: 'c2' }, { c: 'c3' }], b: 2 }, { a: [{ c: 'c4' }, { c: 'c5' }, { c: 'c6' }], b: 4 }, { a: [{ c: 'c7' }, { c: 'c8' }, { c: 'c9' }], b: 6 }];
        var list5 = [{ a: [{ c: 'c1' }, { c: 'c2' }, { c: 'c3' }], b: 2 }, { a: [{ c: 'c4' }, { c: 'c5' }, { c: 'c6' }], b: 4 }];
        var list6 = [{ a: [{ c: 'c1' }, { c: 'c2' }, { c: 'c3' }], b: 2 }];
        var list7 = [];

        var listHtml = [{ a: '<span style="color:red">1</span><span style="color:blue">1</span>', b: '<span style="color:red">2</span><span style="color:blue">2</span>' },
        { a: '<span style="color:red">3</span><span style="color:blue">4</span>', b: '<span style="color:red">5</span><span style="color:blue">6</span>' },
        { a: '<span style="color:red">7</span><span style="color:blue">8</span>', b: '<span style="color:red">9</span><span style="color:blue">0</span>' },
        { a: '<span style="color:red">9</span><span style="color:blue">8</span>', b: '<span style="color:red">7</span><span style="color:blue">6</span>' },
        ];

        var list_case = [{ a: 1, b: "b1" }, { a: 2, b: "b2" }, { a: 3, b: "b3" }, { a: 4, b: "b4" }, { a: 5, b: "b5" }, { a: 6, b: "b6" }, { a: 7, b: "b7" }, { a: 8, b: "b8" }];
    </script>
</head>

<body>
    <!-- <dodo-edit target="body"></dodo-edit> -->

    <!-- <h1 id="dodo-edit-test">dodo</h1>
    <p>template test</p> -->

    <!-- <ul>
      <dodo-tpl  data-for="(x,i)" data-in="list1" data-after-fetch="url" data-after-sse="url" data-fetch="" data-sse="" data-cmd="{create-parent:'ul'}" data-tag="ul">
        <li><dodo-tpl data-text="x.a" /></li>
        <li><dodo-tpl data-text="(x.b)" /></li>
      </dodo-tpl>
    </ul> -->



    <!-- <div style="width:5000px;">
      <span style="display:inline-block;width:2080px;margin:10px;">aaa</span><span style="display:inline-block;width:500px;">bbb</span><span style="display:inline-block;width:500px;">ccc</span>
    </div> -->


    <hr />
    <dodo-tpl id="tpl_context" data-context="{'list':list2}">

        <dodo-tpl for="(x,i)" in="dodoContext.list" data-after-fetch="url" data-after-sse="url" data-fetch=""
            data-sse="" data-cmd="{create-parent:'ul'}" data-tag="ul">
            <li>text:
                <dodo-tpl data-text="'x.a'" />
            </li>
            <li>text:
                <dodo-tpl data-text="(x.b)" />
            </li>

            <dodo-tpl for="(itm,i)" in="x.a">
                <div>text:
                    <dodo-tpl data-text="itm.c" />
                </div>
            </dodo-tpl>

        </dodo-tpl>

        <!-- <dodo-tpl data-context="{'list':list1}">
        <dodo-tpl for="(x,i)" in="dodoContext.list">
          <li>text:<dodo-tpl data-text="x.a" /></li>
          <li>text:<dodo-tpl data-text="(x.b)" /></li>
        </dodo-tpl>
      </dodo-tpl> -->

    </dodo-tpl>
    <hr />
    <dodo-tpl for="(x,i)" in="listHtml">
        <div>text1:<dodo-tpl data-html="x.a"></dodo-tpl>
        </div>
        <div>text2:<dodo-tpl data-html="x.b"></dodo-tpl>
        </div>
    </dodo-tpl>
    <hr />


    <h3>Test Case 1: [ case(arg) when(==value) then (output) ] </h3>
    <dodo-tpl for="(x,i)" in="list_case">
        <dodo-tpl case="x.a">
            <dodo-tpl when="1"><span style="color:red">
                    <dodo-tpl data-text="x.a"></dodo-tpl>
                </span></dodo-tpl>
            <dodo-tpl else> <span style="color:green">
                    <dodo-tpl data-text="x.a"></dodo-tpl>
                </span></dodo-tpl>
        </dodo-tpl>

    </dodo-tpl>

    <h3>Test Case 2: [ case when(expression) then (output) ] </h3>
    <dodo-tpl for="(x,i)" in="list_case">
        <dodo-tpl case>
            <dodo-tpl when="(x.a%2)==0"><span style="color:red">
                    <dodo-tpl data-text="x.a"></dodo-tpl>
                </span></dodo-tpl>
            <dodo-tpl when="(x.a%3)==0"><span style="color:blue">
                    <dodo-tpl data-text="x.a"></dodo-tpl>
                </span></dodo-tpl>
            <dodo-tpl else=""><span style="color:green">
                    <dodo-tpl data-text="x.a"></dodo-tpl>
                </span></dodo-tpl>
        </dodo-tpl>
    </dodo-tpl>


    <h3>Test Case 3: [ case when case ] </h3>
    <dodo-tpl for="(x,i)" in="list_case">
        <dodo-tpl id="id_case_test" case>
            <dodo-tpl when="typeof(x)!='undefined'">
                <span style="color:red">
                    <dodo-tpl case>
                        <dodo-tpl when="(x.a%2)==0">
                            <dodo-tpl data-text="x.b"></dodo-tpl>
                        </dodo-tpl>
                        <dodo-tpl else >
                            <dodo-tpl data-text="x.a"></dodo-tpl>
                        </dodo-tpl>
                    </dodo-tpl>
                </span>
            </dodo-tpl>
            <dodo-tpl else>
                <span style="color:green">
                    <dodo-tpl data-text="x.a"></dodo-tpl>
                </span>
            </dodo-tpl>
        </dodo-tpl>

    </dodo-tpl>






    <hr />
    <!-- <template is="do-do-tpl" data-context="{'list':list2}">

      <dodo-tpl data-for="(x,i)" data-in="dodoContext.list" data-after-fetch="url" data-after-sse="url" data-fetch="" data-sse="" data-cmd="{create-parent:'ul'}" data-tag="ul">
        <li><dodo-tpl data-text="'x.a'" /></li>
        <li><dodo-tpl data-text="(x.b)" /></li>
        



        <dodo-tpl for="(itm,i)" in="x.a">
          <div><dodo-tpl data-text="itm.c" /></div>
        </dodo-tpl>
      </dodo-tpl>
      
    </template> -->

    <div id="mov_point"></div>

    <!-- <dodo-tpl data-begin>
      <dodo-tpl data-if="(x.a&1 == 0)" >
        <li>if ok</li>
      </dodo-tpl>
      <div></div>
      <dodo-tpl data-elseif="(x.a&1 == 0)" >
        <li>else if ok</li>
      </dodo-tpl>
      <dodo-tpl data-else="" >
        <li>else ok</li>
      </dodo-tpl>
    </dodo-tpl>

    <do-case>
      <do-when>1</do-when>
      <do-when>2</do-when>
      <do-else>3</do-else>
    </do-case>


    <dodo-tpl data-case="">
      <dodo-tpl data-when=""></dodo-tpl>
      <dodo-tpl data-when=""></dodo-tpl>
      <dodo-tpl data-else=""></dodo-tpl>
    </dodo-tpl> -->

    <!-- <template>
      <div></div>
    </template> -->

</body>

</html>
<script type="module" defer>
    import TemplateDodo from "/javascripts/template/template-dodo.js";
    import {TemplateContext,Context} from "/javascripts/template/template-context.js";
    import Utils from "/javascripts/utils.js";

    window.addEventListener("templatedodo-complete",(e)=>{
        console.log(e);
        let node = document.querySelector("#tpl_context");
        // node.moveTo(document.querySelector("#mov_point"));



        let sourceNode = document.querySelector('dodo-tpl[in="list_case"]');
        var ulClone = document.importNode( sourceNode,true);
        if( TemplateContext.GetContextByNode(sourceNode).owner == sourceNode){

            let oldContext = TemplateContext.GetContextByNode(sourceNode)
            let context = new Context(oldContext.value);
            context.uuid = Utils.BuildUUID();

            TemplateContext.SaveContext(context);


            ulClone.removeAttribute(TemplateContext.ContextUUID);
        }
        

        document.getElementById("mov_point").appendChild(ulClone);
        // ulClone.in = "list1";
    });



</script>